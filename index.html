<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hanouteek</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <!-- ManyChat Chat Widget Script -->
  <script src="//widget.manychat.com/FacebookPageID.js"></script> <!-- Replace FacebookPageID with your actual Facebook Page ID -->
</head>
<body class="p-4">
  <!-- Header Section -->
  <header class="mb-4">
    <h1 class="text-3xl font-bold text-center">Hanouteek</h1>
    <nav class="flex justify-center space-x-4">
      <a href="#" class="hover:text-blue-500">الرئيسية</a>
      <a href="#" class="hover:text-blue-500">التصنيفات</a>
      <a href="#" class="hover:text-blue-500">استبدال</a>
      <a href="#" class="hover:text-blue-500">مستودعاتنا</a>
      <a href="#" class="hover:text-blue-500">تتبع طلبي</a>
    </nav>
  </header>

  <!-- Product Categories Section -->
  <section class="mb-4">
    <h2 class="text-xl font-bold">التصنيفات</h2>
    <div class="flex space-x-2">
      <button class="bg-gray-200 px-4 py-2 rounded" onclick="filterProducts('all')">الكل</button>
      <button class="bg-gray-200 px-4 py-2 rounded" onclick="filterProducts('PROMO')">PROMO</button>
      <button class="bg-gray-200 px-4 py-2 rounded" onclick="filterProducts('HOMME')">HOMME</button>
      <button class="bg-gray-200 px-4 py-2 rounded" onclick="filterProducts('FEMME')">FEMME</button>
      <button class="bg-gray-200 px-4 py-2 rounded" onclick="filterProducts('ENFANTS')">ENFANTS</button>
      <button class="bg-gray-200 px-4 py-2 rounded" onclick="filterProducts('New Modèle')">New Modèle</button>
      <button class="bg-gray-200 px-4 py-2 rounded" onclick="filterProducts('Parfums')">Parfums</button>
      <button class="bg-gray-200 px-4 py-2 rounded" onclick="filterProducts('Promos')">Promos</button>
      <button class="bg-gray-200 px-4 py-2 rounded" onclick="filterProducts('Accessoires')">Accessoires</button>
    </div>
  </section>

  <!-- Product Section -->
  <section id="products" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
    <!-- Products will be dynamically added here -->
  </section>

  <!-- Cart Section -->
  <aside class="fixed bottom-4 right-4 bg-gray-100 p-4 rounded-lg shadow-lg">
    <h2 class="text-xl font-bold">سلة التسوق</h2>
    <p>إجمالي: <span id="cart-total">0.00 دج</span></p>
    <button class="bg-blue-500 text-white px-4 py-2 rounded">عرض السلة</button>
  </aside>

  <!-- ManyChat Chat Widget Button -->
  <div class="mc-web-embed mc-theme-light" data-page-id="FacebookPageID"></div> <!-- Replace FacebookPageID -->

  <!-- JavaScript for Dynamic Product Loading -->
  <script>
    // Fetch products from the hosted JSON file
    let allProducts = [];

    async function loadProducts() {
      try {
        const response = await fetch('https://hanouteek.netlify.app/manyChatProducts.json'); // Use the hosted URL
        const data = await response.json();
        allProducts = data.content.messages[0].elements;

        // Dynamically create product cards
        renderProducts(allProducts);
      } catch (error) {
        console.error('Error loading products:', error);
      }
    }

    // Function to render products
    function renderProducts(products) {
      const productsSection = document.getElementById('products');
      productsSection.innerHTML = ''; // Clear existing products

      products.forEach(product => {
        const card = document.createElement('div');
        card.className = 'bg-white p-4 rounded-lg shadow-md';
        card.innerHTML = `
          <img src="${product.image_url}" alt="${product.title}" class="w-full mb-2 rounded-md">
          <h3 class="text-lg font-bold">${product.title}</h3>
          <p class="text-sm">${product.subtitle}</p>
          <button class="bg-blue-500 text-white px-4 py-2 rounded" onclick="addToCart('${product.product.label}', ${product.product.cost / 100})">إضافة إلى السلة</button>
        `;
        productsSection.appendChild(card);
      });
    }

    // Function to filter products by category
    function filterProducts(category) {
      if (category === 'all') {
        renderProducts(allProducts);
      } else {
        const filteredProducts = allProducts.filter(product => product.title.includes(category));
        renderProducts(filteredProducts);
      }
    }

    // Function to add items to the cart
    function addToCart(itemName, price) {
      let cartItems = JSON.parse(localStorage.getItem('cart')) || [];
      cartItems.push({ name: itemName, price });
      localStorage.setItem('cart', JSON.stringify(cartItems));

      updateCartTotal();
    }

    // Function to update the cart total
    function updateCartTotal() {
      const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
      const total = cartItems.reduce((sum, item) => sum + item.price, 0);
      document.getElementById('cart-total').textContent = `${total.toFixed(2)} دج`;
    }

    // Load products when the page loads
    window.onload = () => {
      loadProducts();
      updateCartTotal();
    };
  </script>
</body>
</html>
